# Chapter 5

表达式由一个或多个操作数通过操作符组合起来。

每个表达式都会产生一个结果，如果表达式没有操作符，则结果就是操作数本身。

操作符
+ 一元操作符
作用在一个操作数上

+ 二元操作符
作用在两个操作数上

+ 三元操作符
作用在三个操作数上

## 算术操作符

算术操作符都是左结合，意味着优先级相同时，操作符从左向右依次向操作数结合。

一元操作符优先级最高，然后是乘和除，最后是加和减。
这里的一元操作符指的是`+`和`-`，取正和取负操作。

`%`求余操作只能对整型操作。

## 关系操作符和逻辑操作符

+ `&&`和`||`的短路求值

## 位操作符

+ `~`   位求反
+ `<<`  位左移
+ `>>`  位右移
+ `&`   位与
+ `^`   位异或
+ `|`   位或

右移操作符，对于无符号整数，从左边开始插入0；对于有符号整数，插入符号位的副本或0。

## IO操作符

IO操作符为左结合

IO操作符优先级比算术操作符低，比关系操作符，赋值操作符和条件操作符优先级高。

## 赋值操作符

赋值操作符的左操作数必须是非const的左值。

右结合特性
可以将多个赋值操作写在一个表达式中。

```
int val1,int val2;
val1 = val2 = 1;
```

复合赋值操作符
+ `+=`
+ `-=`
+ `*=`
+ `/=`
+ ...


## 自增操作符

后自增操作符的优先级高于解引用操作符
`*iter++`
所以上述表达式的含义为，将iter的值加1后，返回原值作为解引用的操作数。

## 箭头操作符

点操作符用于获取类类型对象的成员，如果有一个指向该对象的指针，则先要对指针解引用，才能使用点操作符。

```
Person *p = &person;
(*p).age  = 12;
```
因为解引用的优先级低于点操作符，所以要加上圆括号。

为了操作方便，定义了箭头操作符。
以下操作等价
```
Person *p = &person;
person.age = 10;
p->age = 10;
```

## 条件操作符

`cond?expr1:expr2;`
如果cond为`True`计算`expr1`,否则计算`expr2`

## sizeof操作符

返回一个对象或类型名的长度，返回值的类型为`size_t`，长度的单位为字节。

## 逗号操作符

逗号表达式是由一组由逗号分隔的表达式，该表达式从左向右计算，逗号表达式的结果是其最右边表达式的值。

## 类型转换

首先将x转换为double类型，再相加，得到6.4，然后赋给左值，因为左值的类型占据主导地位，所以将6.4转换为6。 
```
int x = 3;
double y = 3.4;
int z = 0;
z = x + y;
```

### 何时发生隐式类型转换

+ 混合类型的表达式
+ 用作条件的表达式，被转为`bool`类型
+ 用表达式初始化变量时，该表达式被转换为对应类型

### 算术转换

整型提升：对于所有比int小的整型，如果所有可能的值包含在int里，会被提升为int，否则，被提升为unsigned int。

#### 其他隐式转换

+ 指针转换
数组会自动转换为指向第一个元素的指针
+ 转换为bool类型
+ 算术类型和bool类型的转换
+ 转换和枚举类型
+ 转换为const对象

### 显式转换

`cast-name<type>(expression);`

cast-name
+ dynamic-cast
+ static-cast
+ const-cast
+ reinterpret-cast

